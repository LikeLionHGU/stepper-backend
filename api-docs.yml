openapi: 3.1.0
info:
  description: |
    2024 ë©‹ìŸì´ì‚¬ìì²˜ëŸ¼ ì¤‘ì•™í•´ì»¤í†¤ ë‚¨ì†¡ë¦¬3ë²ˆì§€íŒ€ ë°ëª¨ API ëª…ì„¸
  version: 0.1.0
  title: stepper
  contact:
    name: zionhann
    email: hanzion1108@gmail.com
servers:
  - url: https://api.zionhann.com/stepper
    description: production
  - url: http://localhost:8080
    description: local
security:
  - X-CSRF-TOKEN: [ ]
tags:
  - name: auth
    description: ì¸ì¦
  - name: image
    description: ì´ë¯¸ì§€
  - name: goals
    description: ì„±ì¥ëª©í‘œ
  - name: journals
    description: ì¼ì§€
  - name: chats
    description: AI ëŒ€í™”
paths:
  # auth
  /v1/csrf:
    get:
      tags:
        - auth
      summary: csrf í† í° ë°œê¸‰
      description: " "
      operationId: issueCsrfToken
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CsrfToken'
              examples:
                CsrfTokenExample:
                  value:
                    parameterName: _csrf
                    token: inU6CJ2UNMf
                    headerName: X-CSRF-TOKEN
  /logout:
    post:
      tags:
        - auth
      summary: ë¡œê·¸ì•„ì›ƒ
      description: " "
      operationId: logout
      responses:
        "200":
          description: OK

  # image
  /v1/images:
    post:
      tags:
        - image
      summary: ì´ë¯¸ì§€ ì—…ë¡œë“œ
      description: " "
      operationId: uploadImage
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/S3Request'
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  imageUrl:
                    type: string
                    description: ì´ë¯¸ì§€ URL
              examples:
                S3ResponseExample:
                  value:
                    url: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...

  # goals
  /v1/goals:
    post:
      tags:
        - goals
      summary: ëª©í‘œ ì¶”ê°€
      description: ëª©í‘œë¥¼ ì¶”ê°€í•œë‹¤.
      operationId: addGoal
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoalRequest'
            examples:
              GoalRequestExample:
                value:
                  title: ì¤‘ì•™í•´ì»¤í†¤ ëŒ€ìƒ
                  startDate: 2024-08-06
                  endDate: 2024-08-07
                  thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
      responses:
        "201":
          description: Created
    get:
      tags:
        - goals
      summary: ë‚´ ëª©í‘œ ëª©ë¡ ì¡°íšŒ
      description: ë‚´ ëª©í‘œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¨ë‹¤.
      operationId: getGoals
      parameters:
        - name: sort
          in: query
          schema:
            type: string
            enum:
              - NEWEST
              - ASC
              - DESC
          description: |
            ì •ë ¬ ìˆœì„œ.
            
            `NEWEST`: ìµœì‹ ìˆœ(ê¸°ë³¸ê°’, ìƒì„± ë‚ ì§œ ê¸°ì¤€)
            
            `ASC`: ì˜¤ë¦„ì°¨ìˆœ(ì´ë¦„ ê¸°ì¤€)
            
            `DESC`: ë‚´ë¦¼ì°¨ìˆœ(ì´ë¦„ ê¸°ì¤€)
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoalResponse'
              examples:
                GoalResponseExample:
                  value:
                    goals:
                      - goalId: 1
                        title: ì¤‘ì•™í•´ì»¤í†¤ ëŒ€ìƒ
                        streak: 3
                        status: OPEN
                        startDate: 24.08.06
                        endDate: 24.08.07
                        thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
                      - goalId: 2
                        title: 5kg ë‹¤ì´ì–´íŠ¸
                        streak: 0
                        status: CLOSED
  /v1/goals/{goalId}:
    put:
      tags:
        - goals
      summary: ëª©í‘œ ìˆ˜ì •(ë‹¬ì„± ìƒíƒœ ë³€ê²½ í¬í•¨)
      description: " "
      operationId: modifyGoal
      parameters:
        - name: goalId
          in: path
          required: true
          schema:
            type: string
          description: ëª©í‘œ ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoalUpdateRequest'
            examples:
              GoalUpdateRequestExample:
                value:
                  title: ì¤‘ì•™í•´ì»¤í†¤ ëŒ€ìƒ
                  startDate: 2024-08-06
                  endDate: 2024-08-07
                  thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
                  status: CLOSED
      responses:
        "200":
          description: OK
    delete:
      tags:
        - goals
      summary: ëª©í‘œ ì‚­ì œ
      description: " "
      operationId: deleteGoal
      parameters:
        - name: goalId
          in: path
          required: true
          schema:
            type: string
          description: ëª©í‘œ ID
      responses:
        "200":
          description: OK

  # journals
  /v1/goals/{goalId}/journals:
    post:
      tags:
        - journals
      summary: íŠ¹ì • ëª©í‘œì˜ ì¼ì§€ ìƒì„±
      description: " "
      operationId: addJournal
      parameters:
        - name: goalId
          in: path
          description: ëª©í‘œ ë²ˆí˜¸
          required: true
          schema:
            type: number
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JournalRequest'
            examples:
              JournalRequestExample:
                value:
                  title: ì§„í–‰ìƒí™© ê³µìœ 
                  content: |
                    ë¯¸íŒ… ì‹œê°„ì— ëŒì•„ê°€ë©´ì„œ ì§„í–‰ìƒí™©ì„ ê³µìœ í–ˆë‹¤. ê°ìì˜ ì—­í• ì€ ì¡´ì¤‘í•˜ë©´ì„œ í•˜ë‚˜ì˜ í”„ë¡œë•íŠ¸ë¥¼ ë‹¤ê°™ì´ ë§Œë“¤ì–´ê°„ë‹¤ëŠ” ëŠë‚Œì´ ë“¤ì–´ ê¸°ë¶„ì´ ì¢‹ì•˜ë‹¤.
                  thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
      responses:
        "201":
          description: Created
    get:
      tags:
        - journals
      summary: íŠ¹ì • ëª©í‘œì˜ ì¼ì§€ ëª©ë¡ ì¡°íšŒ
      description: " "
      operationId: getJournalsOfGoal
      parameters:
        - name: goalId
          in: path
          description: ëª©í‘œ ë²ˆí˜¸
          required: true
          schema:
            type: number
        - name: q
          in: query
          description: ê²€ìƒ‰ í‚¤ì›Œë“œ(ì œëª©+ë‚´ìš©)
          schema:
            type: string
        - name: sort
          in: query
          description: |
            ì •ë ¬ìˆœì„œ
            
            `NEWEST`: ìµœì‹ ìˆœ(ê¸°ë³¸ê°’, ì‘ì„±ì¼ ê¸°ì¤€)
            
            `OLDEST`: ì˜¤ë˜ëœìˆœ(ì‘ì„±ì¼ ê¸°ì¤€)
          schema:
            type: string
            enum:
              - NEWEST
              - OLDEST
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  goals:
                    $ref: '#/components/schemas/GoalResponse'
                  journals:
                    type: array
                    items:
                      $ref: '#/components/schemas/JournalResponse'
              examples:
                JournalResponseExample:
                  value:
                    goal:
                      goalId: 1
                      title: ì¤‘ì•™í•´ì»¤í†¤ ëŒ€ìƒ
                      streak: 3
                      status: OPEN
                      startDate: 24.08.06
                      endDate: 24.08.07
                      thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
                    journals:
                      - journalId: 1
                        title: ì§„í–‰ìƒí™© ê³µìœ 
                        createdDate: 24.07.17
                        thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
                      - journalId: 2
                        title: ì•„ì´ë””ì–´ ë””ë²¨ë¡­
                        createdDate: 24.07.16
                        thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
  /v1/journals/{journalId}:
    get:
      tags:
        - journals
      summary: ì¼ì§€ ìƒì„¸ì •ë³´ ì¡°íšŒ
      description: " "
      operationId: getJournalDetail
      parameters:
        - name: journalId
          in: path
          required: true
          schema:
            type: string
          description: ì¼ì§€ ID
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JournalDetailResponse'
              examples:
                JournalDetailResponseExample:
                  value:
                    journalId: 1
                    title: ì§„í–‰ìƒí™© ê³µìœ 
                    content: |
                      ë¯¸íŒ… ì‹œê°„ì— ëŒì•„ê°€ë©´ì„œ ì§„í–‰ìƒí™©ì„ ê³µìœ í–ˆë‹¤. ê°ìì˜ ì—­í• ì€ ì¡´ì¤‘í•˜ë©´ì„œ í•˜ë‚˜ì˜ í”„ë¡œë•íŠ¸ë¥¼ ë‹¤ê°™ì´ ë§Œë“¤ì–´ê°„ë‹¤ëŠ” ëŠë‚Œì´ ë“¤ì–´ ê¸°ë¶„ì´ ì¢‹ì•˜ë‹¤.
                    createdDate: 24.07.17
    put:
      tags:
        - journals
      summary: ì¼ì§€ ìˆ˜ì •
      description: " "
      operationId: updateJournal
      parameters:
        - name: journalId
          in: path
          required: true
          schema:
            type: string
          description: ì¼ì§€ ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JournalRequest'
            examples:
              JournalUpdateRequestExample:
                value:
                  title: ì¤‘ì•™í•´ì»¤í†¤ ëŒ€ìƒ(ìˆ˜ì •)
                  content: ìˆ˜ì •í•  ë‚´ìš©
                  thumbnail: https://3-namsong-st.s3.ap-northeast-2.amazonaws.com/goals/b46f73d9-fa83-4331-b37d-996897280aa6.jpeg...
      responses:
        "200":
          description: OK
    delete:
      tags:
        - journals
      summary: ì¼ì§€ ì‚­ì œ
      description: " "
      operationId: deleteJournal
      parameters:
        - name: journalId
          in: path
          required: true
          schema:
            type: string
          description: ì¼ì§€ ID
      responses:
        "200":
          description: OK


  # chat
  /v1/goals/{goalId}/chats:
    post:
      tags:
        - chats
      summary: íŠ¹ì • ëª©í‘œì— ëŒ€í•´ AIë¡œ ì¼ì§€ ì‘ì„± ì±„íŒ…ë°© ìƒì„±
      description: " "
      operationId: initChat
      parameters:
        - name: goalId
          in: path
          description: ëª©í‘œ ID
          required: true
          schema:
            type: number
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponse'
              examples:
                ChatResponseExample:
                  value:
                    chatId: thread_StEPpEr
  /v1/chats/{chatId}/history:
    get:
      tags:
        - chats
      summary: íŠ¹ì • ì±„íŒ…ë°©ì˜ ëŒ€í™”ë‚´ì—­ ì¡°íšŒ
      description: " "
      operationId: getChatMessages
      parameters:
        - name: chatId
          in: path
          description: ì±„íŒ…ë°© ID
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/ChatHistoryResponse'
              examples:
                ChatHistoryResponseExample:
                  value:
                    messages:
                      - role: CHATBOT
                        content: "ì•ˆë…•í•˜ì„¸ìš” ğŸ˜Š\nì €ëŠ” ë‹¹ì‹ ì˜ ì„±ì¥ ì—¬ì •ì„ í•¨ê»˜í•  AI (ì±—ë´‡ ì´ë¦„)ì…ë‹ˆë‹¤ :)"
                      - role: CHATBOT
                        content: "ìì‹ ì˜ ìƒê°ê³¼ ê°ì •ì„ ì†”ì§í•˜ê²Œ ê¸°ë¡í•˜ë©´ì„œ, ë§¤ì¼ ì¡°ê¸ˆì”© ë” ë‚˜ì€ ë‚˜ë¥¼ ë°œê²¬í•´ ë³´ì„¸ìš”.\nì˜¤ëŠ˜ì˜ ê¸°ë¡ì´ ë‚´ì¼ì˜ ë‹¹ì‹ ì„ ë”ìš± ë¹›ë‚˜ê²Œ í•  ê±°ì˜ˆìš”.\nì, ì´ì œ ì‹œì‘í•´ ë³¼ê¹Œìš”? ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”!"
                      - role: CHATBOT
                        content: "ì–´ë–¤ ê³„ê¸°ë¡œ â€˜ì¤‘ì•™í•´ì»¤í†¤ ìš°ìŠ¹'ì´ë¼ëŠ” ëª©í‘œë¥¼ ê°€ì§€ê²Œ ë˜ì—ˆë‚˜ìš”?"
                      - role: USER
                        content: "í•œë™ ë©‹ì‚¬ì—ì„œ ì•„ê¸°ì‚¬ìë¡œ í™œë™í•˜ëŠ” ë™ì•ˆ ìš°ìŠ¹í•˜ê³  ì‹¶ì–´!"
  /v1/chats/{chatId}/summary:
    post:
      tags:
        - chats
      summary: íŠ¹ì • ì±„íŒ…ë°©ì˜ ëŒ€í™” ë‚´ìš© ìš”ì•½ (ì¼ì§€ ì´ˆì•ˆ ì‘ì„±)
      description: " "
      operationId: chatSummary
      parameters:
        - name: chatId
          in: path
          description: ì±„íŒ…ë°© ID
          required: true
          schema:
            type: string
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatSummaryResponse'
              examples:
                ChatSummaryResponseExample:
                  value:
                    content: "ì¤‘ì•™í•´ì»¤í†¤ì— ì°¸ì—¬í•˜ë©´ì„œ 'ìš°ìŠ¹'ì´ë¼ëŠ” ëª©í‘œë¥¼ ì„¸ì› ë‹¤. í™œë™ ê¸°ê°„ ë™ì•ˆ ìš°ìŠ¹í•˜ê³  ì‹¶ë‹¤ëŠ” ì—´ë§ì´ ì»¤ì¡Œê³ , ì´ë¥¼ ìœ„í•´ ë§¤ì£¼ ë‘ ë²ˆì”© ëª¨ì—¬ ì„œë¹„ìŠ¤ì— ëŒ€í•œ íšŒì˜ë¥¼ ì§„í–‰í–ˆë‹¤. ì§€ì†ì ìœ¼ë¡œ í”¼ë“œë°±ì„ ì£¼ê³ ë°›ê³ , AI ì±—ë´‡ ê¸°ëŠ¥ì´ ì •ë§ ì¤‘ìš”í•˜ë‹¤ëŠ” ì´ì•¼ê¸°ë¥¼ ë“£ê³  ë°˜ë“œì‹œ ì„ ë³´ì—¬ì•¼ê² ë‹¤ëŠ” ë‹¤ì§ì„ í–ˆë‹¤.\n\nAI ì±—ë´‡ ê¸°ëŠ¥ì˜ ë°œì „ì„ ìœ„í•´ ê¸°ëŠ¥ í”Œë¡œìš°ì— ëŒ€í•œ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ì„ ë§Œë“¤ê³  ìˆœì°¨ì ìœ¼ë¡œ êµ¬í˜„í•´ ë‚˜ê°”ë‹¤."
components:
  securitySchemes:
    X-CSRF-TOKEN:
      type: apiKey
      in: header
      name: X-CSRF-TOKEN
  schemas:
    S3Request:
      type: object
      required:
        - file
      properties:
        file:
          type: string
          format: binary
    GoalRequest:
      type: object
      required:
        - title
      properties:
        title:
          type: string
          description: ëª©í‘œ ì´ë¦„
        startDate:
          type: string
          description: ëª©í‘œ ì‹œì‘ì¼
        endDate:
          type: string
          description: ëª©í‘œ ì¢…ë£Œì¼
        thumbnail:
          type: string
          description: ëª©í‘œ ì¸ë„¤ì¼ ì´ë¯¸ì§€
    GoalUpdateRequest:
      type: object
      properties:
        title:
          type: string
          description: ëª©í‘œ ì´ë¦„
        startDate:
          type: string
          description: ëª©í‘œ ì‹œì‘ì¼
        endDate:
          type: string
          description: ëª©í‘œ ì¢…ë£Œì¼
        thumbnail:
          type: string
          description: ì¸ë„¤ì¼ ì´ë¯¸ì§€ URL
        status:
          type: string
          enum:
            - OPEN
            - CLOSED
            - OVERDUE
          description: ëª©í‘œ ìƒíƒœ
    GoalResponse:
      type: object
      properties:
        goalId:
          type: number
          description: ëª©í‘œ ID
        title:
          type: string
          description: ëª©í‘œ ì´ë¦„
        streak:
          type: number
          description: ì—°ì†ì‘ì„±ì¼ìˆ˜
        status:
          type: string
          enum:
            - OPEN
            - CLOSED
            - OVERDUE
          description: ëª©í‘œ ìƒíƒœ
        startDate:
          type: string
          description: ëª©í‘œ ì‹œì‘ì¼
        endDate:
          type: string
          description: ëª©í‘œ ì¢…ë£Œì¼
        thumbnail:
          type: string
          description: ëª©í‘œ ì¸ë„¤ì¼ ì´ë¯¸ì§€
    JournalRequest:
      type: object
      required:
        - title
        - content
      properties:
        title:
          type: string
          description: ì¼ì§€ì œëª©
        content:
          type: string
          description: ì¼ì§€ë‚´ìš©
        thumbnail:
          type: string
          description: ì¸ë„¤ì¼ ì´ë¯¸ì§€ URL
    JournalResponse:
      type: object
      properties:
        journalId:
          type: number
          description: ì¼ì§€ ID
        title:
          type: string
          description: ì¼ì§€ ì œëª©
        createdDate:
          type: string
          description: ì‘ì„±ì¼ì
        thumbnail:
          type: string
          description: ì¸ë„¤ì¼ ì´ë¯¸ì§€ URL
    JournalDetailResponse:
      type: object
      properties:
        journalId:
          type: number
          description: ì¼ì§€ ID
        title:
          type: string
          description: ì¼ì§€ ì œëª©
        content:
          type: string
          description: ì¼ì§€ ë‚´ìš©
        createdDate:
          type: string
          description: ì‘ì„±ì¼
    CsrfToken:
      type: object
      properties:
        parameterName:
          type: string
          description: csrf íŒŒë¼ë¯¸í„° í‚¤ê°’
        token:
          type: string
          description: csrf í† í°
        headerName:
          type: string
          description: csrf í—¤ë” í‚¤ê°’
    ChatResponse:
      type: object
      properties:
        chatId:
          type: string
          description: ì±„íŒ…ë°© ID
    ChatHistoryResponse:
      type: object
      properties:
        role:
          type: string
          description: ë©”ì‹œì§€ ì£¼ì²´
        content:
          type: string
          description: ë©”ì‹œì§€ ë‚´ìš©
    ChatSummaryResponse:
      type: object
      properties:
        content:
          type: string
          description: ìš”ì•½í•œ ë‚´ìš©